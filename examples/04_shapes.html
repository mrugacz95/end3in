<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shapes</title>
    <script src="../build/end3in.js"></script>
</head>
<body></body>
<script>
    const Engine = end3in.Engine,
        Body = end3in.Body,
        Collision = end3in.Collision,
        Graphics = end3in.Graphics;

    let engine = Engine.create(debug = true, solver = "none");
    const triangle = Body.polygon([[-1, -0.255], [1, -0.255], [0, 0.6]], 1, 2, {
        'isStatic': true,
        'color': "#141ae6EE",
        "rot": 0
    }); // Math.PI / 4
    const polygon1 = Body.polygon([[-0.25, 0], [0, -0.5], [0.69, -0.76], [1.2, 0.8]],
        0.8, 4.2, {
            'isStatic': true,
            'color': "#141ae6EE",
            "rot": Math.PI / 6
        });
    const polygon2 = Body.polygon([[0.62, -0.40], [0.65, 0.25], [0.44, 0.37], [-0.4, -0.20]],
        3.3, 2.0, {
            'isStatic': true,
            'color': "#141ae6EE",
            "rot": Math.PI / 6
        });
    const rect1 = Body.rect(1, 1, 2, -1, {
        'isStatic': true,
        'color': "#141ae6EE",
        "rot": Math.PI / 4
    });


    let graphics = Graphics.create(1000, 1000, engine, true)
    graphics.start()

    engine.addBody(triangle);
    engine.addBody(polygon1);
    engine.addBody(polygon2);
    engine.addBody(rect1);
    engine.start();


    document.addEventListener("keydown", event => {
        if (event.isComposing || event.code === 'ArrowLeft') {
            triangle.rot += 2 * Math.PI / 180.0;
        }
        if (event.isComposing || event.code === 'ArrowRight') {
            triangle.rot -= 2 * Math.PI / 180.0;
        }
    });
    document.onmousemove = function (event) {
        triangle.pos = graphics.clientToWorldPos(Vec2.create(event.clientX, event.clientY))
        triangle.color = "#141ae6EE";

        for (let gameObj of engine.gameObjects) {
            if (gameObj === triangle) {
                continue;
            }
            if (Collision.calculateSAT(gameObj, triangle, {'context': graphics.ctx, 'debug': true})) {
                triangle.color = "#e62131EE";
            }
        }
    }

</script>
</html>