<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SAT collisions</title>
    <script src="../build/end3in.js"></script>
</head>
<body style="margin: 0;">

<canvas height="1000px" id="canvas" width="1000px"></canvas>
<script>
    var Engine = end3in.Engine,
        Body = end3in.Body,
        Collision = end3in.Collision;
    let engine = Engine.create();
    var rect1 = Body.rect(0.5, 0.5, 1, 2, {'isStatic': true, 'color': "#141ae6EE", "rot": Math.PI / 3}); // Math.PI / 4
    var polygon1 = Body.polygon([[1, -1], [0, -0.5], [-0.25, 0], [1, 1]],
        0.8, 4.2, {
            'isStatic': true,
            'color': "#141ae6EE",
            "rot": Math.PI / 6
        });
    var polygon2 = Body.polygon([[0.5, -0.35], [0.75, 0.5], [0.44, 0.37], [-0.4, -0.20]],
        3.3, 2.0, {
            'isStatic': true,
            'color': "#141ae6EE",
            "rot": Math.PI / 6
        });
    engine.addBody(rect1);
    engine.addBody(polygon1);
    engine.addBody(polygon2);
    var clear = engine.clear;
    var draw = engine.draw;
    engine.clear = function () {
    };
    engine.draw = function () {
    };
    engine.start();
    document.onmousemove = function (event) {
        clear.call(engine);
        draw.call(engine);
        rect1.pos = Vec2.create(event.clientX / engine.scale, event.clientY / engine.scale).sub(engine.cameraPos);
        rect1.color = "#141ae6EE";

        engine.ctx.save();
        engine.ctx.translate(engine.cameraPos.x * engine.scale, engine.cameraPos.y * engine.scale);
        if (Collision.calculateSAT(rect1, polygon1, {'context': engine.ctx, 'debug': true})) {
            rect1.color = "#e62131EE";
        }
        if (Collision.calculateSAT(rect1, polygon2, {'context': engine.ctx, 'debug': true})) {
            rect1.color = "#e62131EE";
        }
        engine.ctx.restore();
    }

</script>

</body>
</html>